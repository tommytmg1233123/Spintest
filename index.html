<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>RNG World</title>

<style>
body{
    margin:0;
    overflow:hidden;
    font-family:Arial;
}

/* ===== STATS BAR ===== */

#stats{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    background:#000000aa;
    color:white;
    padding:10px 20px;
    font-size:20px;
    display:flex;
    gap:30px;
    z-index:20;
}

/* ===== WORLD ===== */

#world{
    position:fixed;
    inset:0;
    background:#1a1a1a;
    background-image:url("https://i.imgur.com/AcBA0Pi.jpeg");
    background-size:cover;
    background-position:center;
    background-attachment:fixed;
    overflow:hidden;
}

.ground{
    position:absolute;
    bottom:0;
    height:180px;
    width:100%;
    background:transparent;
}

/* RIVER */
.river{
    position:absolute;
    bottom:0;
    height:120px;
    width:200px;
    background:transparent;
}

/* ===== WHEEL TOP ===== */

#wheelWrap{
    position:fixed;
    top:60px;
    left:50%;
    transform:translateX(-50%);
    width:900px;
    height:140px;
    overflow:hidden;
    background:#111;
    border:3px solid white;
    border-radius:12px;
}

#wheel{
    display:flex;
}

.item{
    width:140px;
    height:140px;
    margin:0 4px;
    display:flex;
    align-items:center;
    justify-content:center;
    background:#222;
    border-radius:10px;
}

.item img{
    width:120px;
    height:120px;
    border-radius:8px;
}

/* PIN TOP */

#pin{
    position:fixed;
    top:40px;
    left:50%;
    transform:translateX(-50%);
    font-size:50px;
    color:red;
    z-index:10;
}

/* ===== BUTTONS BOTTOM ===== */

#ui{
    position:fixed;
    bottom:30px;
    left:50%;
    transform:translateX(-50%);
    text-align:center;
    display:flex;
    flex-direction:column;
    gap:12px;
    z-index:15;
}

.btn{
    padding:14px 50px;
    font-size:22px;
    font-weight:bold;
    border-radius:8px;
    border:3px solid #333;
    background:linear-gradient(180deg, #4caf50 0%, #388e3c 100%);
    color:white;
    cursor:pointer;
    text-shadow:2px 2px 4px rgba(0,0,0,0.5);
    box-shadow:0 4px 8px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.2);
    transition:all 0.1s;
}

.btn:hover{
    background:linear-gradient(180deg, #66bb6a 0%, #43a047 100%);
    transform:translateY(-2px);
    box-shadow:0 6px 12px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.3);
}

.btn:active{
    transform:translateY(0);
    box-shadow:0 2px 4px rgba(0,0,0,0.4), inset 0 1px 0 rgba(0,0,0,0.2);
}

/* ===== MUSIC BUTTON BOTTOM RIGHT ===== */

#musicBtn{
    position:fixed;
    bottom:30px;
    right:30px;
    padding:12px 20px;
    font-size:20px;
    font-weight:bold;
    border-radius:8px;
    border:3px solid #333;
    background:linear-gradient(180deg, #4caf50 0%, #388e3c 100%);
    color:white;
    cursor:pointer;
    text-shadow:2px 2px 4px rgba(0,0,0,0.5);
    box-shadow:0 4px 8px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.2);
    transition:all 0.1s;
    z-index:15;
}

#musicBtn:hover{
    background:linear-gradient(180deg, #66bb6a 0%, #43a047 100%);
    transform:translateY(-2px);
    box-shadow:0 6px 12px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.3);
}

#musicBtn:active{
    transform:translateY(0);
    box-shadow:0 2px 4px rgba(0,0,0,0.4), inset 0 1px 0 rgba(0,0,0,0.2);
}

/* ===== POPUP ===== */

#popup{
    position:fixed;
    top:40%;
    left:50%;
    transform:translateX(-50%);
    font-size:60px;
    font-weight:bold;
    display:none;
}

/* FLASH */

#flash{
    position:fixed;
    inset:0;
    opacity:0;
    pointer-events:none;
    transition:opacity .2s;
}
</style>
</head>

<body>

<!-- ===== STATS BAR ===== -->
<div id="stats">
    <div>Total Spins: <span id="s_total">0</span></div>
    <div>Common: <span id="s_common">0</span></div>
    <div>Rare: <span id="s_rare">0</span></div>
    <div>Ultra: <span id="s_ultra">0</span></div>
    <div>Mythic: <span id="s_mythic">0</span></div>
    <div>Divine: <span id="s_divine">0</span></div>
</div>

<div id="world">
    <div class="ground"></div>
</div>

<div id="pin">â–¼</div>

<div id="wheelWrap">
    <div id="wheel"></div>
</div>

<div id="ui">
    <button class="btn" id="spinBtn">SPIN</button>
    <button class="btn" id="skipBtn">SKIP</button>
</div>

<button id="musicBtn">ðŸ”Š ON</button>

<div id="popup"></div>
<div id="flash"></div>

<audio id="bgMusic" loop></audio>
<audio id="tick" src="tick.mp3"></audio>
<audio id="spinSound" src="spin.mp3"></audio>

<script>

/* ===== BACKGROUND MUSIC ===== */

let musicOn=true;
let musicStarted=false;
const bgMusic=document.getElementById("bgMusic");
const musicBtn=document.getElementById("musicBtn");

// IMPORTANT: Spotify links DO NOT WORK in browsers due to copyright protection
// You MUST use a direct MP3 URL instead. Here are your options:

// OPTION 1: Use a free music hosting site (Recommended)
// Upload your Blue Boi MP3 to one of these and replace the URL:
// - Discord CDN (upload to Discord, get the link)
// - Dropbox (share link, add ?dl=1 at the end)
// - Google Drive (share link, extract the file ID)
// - AWS S3, Firebase Storage, or similar

// OPTION 2: Download from Spotify and host it yourself
// 1. Download Blue Boi as MP3 from YouTube or music converter
// 2. Upload to a hosting service
// 3. Replace the URL below with the direct link

// EXAMPLE: If using Dropbox, your URL would be:
// bgMusic.src="https://dl.dropboxusercontent.com/s/your-file-id/blueboi.mp3?dl=1";

bgMusic.src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3";
bgMusic.volume=0.3;
bgMusic.crossOrigin="anonymous";

document.addEventListener("click",()=>{
    if(!musicStarted){
        bgMusic.play().catch(e=>console.log("Music error:",e));
        musicStarted=true;
    }
});

musicBtn.onclick=(e)=>{
    e.stopPropagation();
    musicOn=!musicOn;
    if(musicOn){
        bgMusic.play().catch(e=>console.log("Music error:",e));
        musicBtn.innerText="ðŸ”Š ON";
    }else{
        bgMusic.pause();
        musicBtn.innerText="ðŸ”‡ OFF";
    }
};

/* ===== STATS SYSTEM ===== */

let stats={
    total:0,
    Common:0,
    Rare:0,
    Ultra:0,
    Mythic:0,
    Divine:0
};

function updateStats(){
    document.getElementById("s_total").innerText=stats.total;
    document.getElementById("s_common").innerText=stats.Common;
    document.getElementById("s_rare").innerText=stats.Rare;
    document.getElementById("s_ultra").innerText=stats.Ultra;
    document.getElementById("s_mythic").innerText=stats.Mythic;
    document.getElementById("s_divine").innerText=stats.Divine;
}

/* ===== RNG WITH FIXED RARITIES ===== */

const RARITIES=[
    {name:"Common",chance:55,color:"#888"},
    {name:"Rare",chance:25,color:"#2196f3"},
    {name:"Ultra",chance:15,color:"#9c27b0"},
    {name:"Mythic",chance:4,color:"#ff9800"},
    {name:"Divine",chance:1,color:"#ffd700"}
];

// EACH MEME NOW HAS A FIXED RARITY
// To add more memes:
// 1. Add a new line with: {img:"URL",rarity:"Rarity"}
// 2. Change rarity to: "Common", "Rare", "Ultra", "Mythic", or "Divine"
// 3. A meme can ONLY be one rarity - it won't change on different rolls

const MEMES=[
    // COMMON MEMES
    {img:"https://i.imgflip.com/30b1gx.jpg",rarity:"Common"},
    {img:"https://i.imgflip.com/1ur9b0.jpg",rarity:"Common"},
    {img:"https://i.imgflip.com/2fm6x.jpg",rarity:"Common"},
    
    // RARE MEMES
    {img:"https://i.imgflip.com/1g8my.jpg",rarity:"Rare"},
    {img:"https://i.imgflip.com/265k.jpg",rarity:"Rare"},
    
    // ULTRA MEMES
    {img:"https://i.imgflip.com/2hgfw.jpg",rarity:"Ultra"},
    {img:"https://i.imgflip.com/4t0m5.jpg",rarity:"Ultra"},
    
    // MYTHIC MEMES
    {img:"https://i.imgflip.com/1bij.jpg",rarity:"Mythic"},
    
    // DIVINE MEMES
    {img:"https://i.imgflip.com/1siru.jpg",rarity:"Divine"}
];

const wheel=document.getElementById("wheel");

function buildWheel(){
    wheel.innerHTML="";
    for(let i=0;i<400;i++){ 
        let m=MEMES[i%MEMES.length];
        let r=RARITIES.find(x=>x.name===m.rarity);

        let d=document.createElement("div");
        d.className="item";
        d.style.boxShadow=`0 0 20px ${r.color}`;
        d.innerHTML=`<img src="${m.img}">`;

        wheel.appendChild(d);
    }
}
buildWheel();

function pick(){
    let roll=Math.random()*100;
    let sum=0;
    for(let r of RARITIES){
        sum+=r.chance;
        if(roll<=sum){
            // Get all memes of this rarity and pick one randomly
            let pool=MEMES.filter(m=>m.rarity===r.name);
            return pool[Math.floor(Math.random()*pool.length)];
        }
    }
    return MEMES[0];
}

/* ===== SPIN SYSTEM ===== */

let spinning=false;
let tickInterval;
let spinStart;

document.getElementById("spinBtn").onclick=startSpin;
document.getElementById("skipBtn").onclick=skipSpin;

function startSpin(){

    if(spinning) return;
    spinning=true;

    wheel.style.transition="none";
    wheel.style.transform="translateX(0px)";
    wheel.offsetHeight;

    let duration=6000;
    spinStart=performance.now();

    startTickSound();
    playSpinSound();

    function anim(t){

        let p=(t-spinStart)/duration;
        if(p>1)p=1;

        let ease=1-Math.pow(1-p,3);
        let move=ease*9000;

        wheel.style.transform=`translateX(-${move}px)`;

        updateTickSpeed(p);

        if(p<1 && spinning){
            requestAnimationFrame(anim);
        }else{
            finishSpin();
        }
    }

    requestAnimationFrame(anim);
}

function startTickSound(){
    let t=document.getElementById("tick");
    tickInterval=setInterval(()=>{
        t.currentTime=0;
        t.play().catch(e=>console.log("Audio play failed:",e));
    },60);
}

function updateTickSpeed(progress){
    clearInterval(tickInterval);
    let speed=60+(progress*300);
    tickInterval=setInterval(()=>{
        let t=document.getElementById("tick");
        t.currentTime=0;
        t.play().catch(e=>console.log("Audio play failed:",e));
    },speed);
}

function playSpinSound(){
    let sound=document.getElementById("spinSound");
    sound.currentTime=0;
    sound.play().catch(e=>console.log("Spin sound failed:",e));
}

function skipSpin(){
    if(!spinning)return;
    spinning=false;
    finishSpin();
}

function finishSpin(){

    clearInterval(tickInterval);

    let meme=pick();
    let r=RARITIES.find(x=>x.name===meme.rarity);

    /* UPDATE STATS */
    stats.total++;
    stats[r.name]++;
    updateStats();

    showPopup(r);
    flash(r.color);

    spinning=false;
}

function showPopup(r){
    let p=document.getElementById("popup");
    p.innerText=r.name;
    p.style.color=r.color;
    p.style.display="block";
    setTimeout(()=>p.style.display="none",1500);
}

function flash(color){
    let f=document.getElementById("flash");
    f.style.background=color;
    f.style.opacity="0.5";
    setTimeout(()=>f.style.opacity="0",300);
}

</script>
</body>
</html>
